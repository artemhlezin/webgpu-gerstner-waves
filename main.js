(()=>{"use strict";var e={772:(e,t,n)=>{n.d(t,{Z:()=>A});var r=n(81),o=n.n(r),a=n(645),i=n.n(a)()(o());i.push([e.id,"canvas {\n  touch-action: none;\n}\n",""]);const A=i},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var A=0;A<this.length;A++){var s=this[A][0];null!=s&&(i[s]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);r&&i[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),t.push(c))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var a={},i=[],A=0;A<e.length;A++){var s=e[A],u=r.base?s[0]+r.base:s[0],c=a[u]||0,l="".concat(u," ").concat(c);a[u]=c+1;var d=n(l),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==d)t[d].references++,t[d].updater(f);else{var p=o(f,r);r.byIndex=A,t.splice(A,0,{identifier:l,updater:p,references:1})}i.push(l)}return i}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var a=r(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var A=n(a[i]);t[A].references--}for(var s=r(e,o),u=0;u<a.length;u++){var c=n(a[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}a=s}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},558:e=>{e.exports="[[block]]  // Deprecated: [[block]] attributes have been removed from WGSL\nstruct Uniforms {\n    elapsedTime: f32;\n    [[align(16)]] modelMatrix: mat4x4<f32>;  // Explicitly set alignment\n    viewProjectionMatrix: mat4x4<f32>;\n    cameraPosition: vec3<f32>;\n};\n\nstruct GerstnerWaveParameters {\n    length: f32;  // 0 < L\n    amplitude: f32; // 0 < A\n    steepness: f32;  // Steepness of the peak of the wave. 0 <= S <= 1\n    [[size(16), align(8)]] direction: vec2<f32>;  // Normalized direction of the wave\n};\n\n[[block]]  // Deprecated: [[block]] attributes have been removed from WGSL\nstruct GerstnerWavesUniforms {\n    waves: [[stride(32)]] array<GerstnerWaveParameters, 5>;\n    amplitudeSum: f32;  // Sum of waves amplitudes\n};\n\nstruct VertexOutput {\n    [[builtin(position)]] position: vec4<f32>;\n    [[location(0)]] normal: vec4<f32>;\n    [[location(1)]] uv: vec2<f32>;\n    [[location(2)]] worldPosition: vec4<f32>;\n};\n\n[[group(0), binding(0)]] var<uniform> uniforms: Uniforms;\n[[group(0), binding(1)]] var<uniform> wavesUniforms: GerstnerWavesUniforms;\n\n[[group(1), binding(0)]] var seaSampler: sampler;\n[[group(1), binding(1)]] var seaColor: texture_2d<f32>;\n\n\nlet pi = 3.14159;   \nlet gravity = 9.8; // m/sec^2\nlet waveNumbers = 5;  \n\n[[stage(vertex)]]\nfn vertex_main(\n    [[location(0)]] position: vec3<f32>,\n    [[location(1)]] normal: vec3<f32>,\n    [[location(2)]] uv: vec2<f32>,\n) -> VertexOutput {\n    var output: VertexOutput;\n    var worldPosition: vec4<f32> = uniforms.modelMatrix * vec4<f32>(position, 1.0);\n\n    var wavesSum: vec3<f32> = vec3<f32>(0.0);\n    var wavesSumNormal: vec3<f32>;\n    for(var i: i32 = 0; i < waveNumbers; i = i + 1) {\n        let wave = wavesUniforms.waves[i];\n        let wavevectorMagnitude = 2.0 * pi / wave.length;\n        let wavevector = wave.direction * wavevectorMagnitude;\n        let temporalFrequency = sqrt(gravity * wavevectorMagnitude);\n        let steepnessFactor = wave.steepness / (wave.amplitude * wavevectorMagnitude * f32(waveNumbers)); \n        \n        let pos = dot(wavevector, worldPosition.xz) - temporalFrequency * uniforms.elapsedTime;\n        let sinPosAmplitudeDirection = sin(pos) * wave.amplitude * wave.direction;\n        \n        var offset: vec3<f32>;\n        offset.x = sinPosAmplitudeDirection.x * steepnessFactor;\n        offset.z = sinPosAmplitudeDirection.y * steepnessFactor;\n        offset.y = cos(pos) * wave.amplitude;\n\n        var normal: vec3<f32>;\n        normal.x = sinPosAmplitudeDirection.x * wavevectorMagnitude;\n        normal.z = sinPosAmplitudeDirection.y * wavevectorMagnitude;\n        normal.y = cos(pos) * wave.amplitude * wavevectorMagnitude * steepnessFactor;\n\n        wavesSum = wavesSum + offset;\n        wavesSumNormal = wavesSumNormal + normal;\n    }\n    wavesSumNormal.y = 1.0 - wavesSumNormal.y;\n    wavesSumNormal = normalize(wavesSumNormal);\n\n    worldPosition.x = worldPosition.x - wavesSum.x;\n    worldPosition.z = worldPosition.z - wavesSum.z;\n    worldPosition.y = wavesSum.y;\n\n    output.worldPosition = worldPosition;\n    output.position = uniforms.viewProjectionMatrix * worldPosition;\n    output.normal = vec4<f32>(wavesSumNormal, 0.0);\n    output.uv = uv;\n    return output;\n}\n\n[[stage(fragment)]]\nfn fragment_main(\n    data: VertexOutput,\n) -> [[location(0)]] vec4<f32> {\n    let lightColor = vec3<f32>(1.0, 0.8, 0.65);\n    let skyColor = vec3<f32>(0.69, 0.84, 1.0);\n\n    let lightPosition = vec3<f32>(-10.0, 1.0, -10.0);\n    let light = normalize(lightPosition - data.worldPosition.xyz);  // Vector from surface to light\n    let eye = normalize(uniforms.cameraPosition - data.worldPosition.xyz);  // Vector from surface to camera\n    let reflection = reflect(data.normal.xyz, -eye);  // I - 2.0 * dot(N, I) * N\n    \n    let halfway = normalize(eye + light);  // Vector between View and Light\n    let shininess = 30.0;\n    let specular = clamp(pow(dot(data.normal.xyz, halfway), shininess), 0.0, 1.0) * lightColor;  // Blinn-Phong specular component\n\n    let fresnel = clamp(pow(1.0 + dot(-eye, data.normal.xyz), 4.0), 0.0, 1.0);  // Cheap fresnel approximation\n\n    // Normalize height to [0, 1]\n    let normalizedHeight = (data.worldPosition.y + wavesUniforms.amplitudeSum) / (2.0 * wavesUniforms.amplitudeSum);\n    let underwater = textureSample(seaColor, seaSampler, vec2<f32>(normalizedHeight, 0.0)).rgb;\n\n    // Approximating Translucency (GPU Pro 2 article)\n    let distortion = 0.1;\n    let power = 4.0;\n    let scale = 1.0;\n    let ambient = 0.2;\n    let thickness = smoothStep(0.0, 1.0, normalizedHeight);\n    let distortedLight = light + data.normal.xyz * distortion;\n    let translucencyDot = pow(clamp(dot(eye, -distortedLight), 0.0, 1.0), power);\n    let translucency = (translucencyDot * scale + ambient) * thickness;\n    let underwaterTranslucency = mix(underwater, lightColor, translucency) * translucency;\n\n    let color = mix(underwater + underwaterTranslucency, skyColor, fresnel) + specular;\n\n    return vec4<f32>(color, 1.0);\n}"},542:e=>{e.exports="data:image/webp;base64,UklGRvoCAABXRUJQVlA4WAoAAAAgAAAAfwAAAAAASUNDUBgCAAAAAAIYAAAAAAQwAABtbnRyUkdCIFhZWiAAAAAAAAAAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAAHRyWFlaAAABZAAAABRnWFlaAAABeAAAABRiWFlaAAABjAAAABRyVFJDAAABoAAAAChnVFJDAAABoAAAAChiVFJDAAABoAAAACh3dHB0AAAByAAAABRjcHJ0AAAB3AAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAFgAAAAcAHMAUgBHAEIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z3BhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABYWVogAAAAAAAA9tYAAQAAAADTLW1sdWMAAAAAAAAAAQAAAAxlblVTAAAAIAAAABwARwBvAG8AZwBsAGUAIABJAG4AYwAuACAAMgAwADEANlZQOEy8AAAAL38AAAAvoqaRFOi2xgU1/rUgAR2vhgkwzEbSzG8R1mb9RQ7gCOZfgds2yhgO8o6wECBa0RUgAnaXzyZpiAfABAScODRQfRtnUcxLABwGAFi2klJb6WzXNoIpov8BAAAAAIZhGJbjeEEQJdl1F8vVerPd7Q/H0/lyvd0fz6Zpu74fxnGa53lGCCGEEEIIIYQxIZRS+v58v9/f7//yPN8PwjCK4jhJ0yzLi7KsakVVNV03DNOyLNt2HAghhBA="}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;var t=Math.PI/180;function r(e){return e*t}function o(){var t=new e(16);return e!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function a(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],A=t[5],s=t[6],u=t[7],c=t[8],l=t[9],d=t[10],f=t[11],p=t[12],h=t[13],v=t[14],m=t[15],g=n*A-r*i,w=n*s-o*i,y=n*u-a*i,E=r*s-o*A,x=r*u-a*A,P=o*u-a*s,b=c*h-l*p,M=c*v-d*p,S=c*m-f*p,T=l*v-d*h,B=l*m-f*h,U=d*m-f*v,N=g*U-w*B+y*T+E*S-x*M+P*b;return N?(N=1/N,e[0]=(A*U-s*B+u*T)*N,e[1]=(o*B-r*U-a*T)*N,e[2]=(h*P-v*x+m*E)*N,e[3]=(d*x-l*P-f*E)*N,e[4]=(s*S-i*U-u*M)*N,e[5]=(n*U-o*S+a*M)*N,e[6]=(v*y-p*P-m*w)*N,e[7]=(c*P-d*y+f*w)*N,e[8]=(i*B-A*S+u*b)*N,e[9]=(r*S-n*B-a*b)*N,e[10]=(p*x-h*y+m*g)*N,e[11]=(l*y-c*x-f*g)*N,e[12]=(A*M-i*T-s*b)*N,e[13]=(n*T-r*M+o*b)*N,e[14]=(h*w-p*E-v*g)*N,e[15]=(c*E-l*w+d*g)*N,e):null}function i(e,t,n){var r,o,a,i,A,s,u,c,l,d,f,p,h=n[0],v=n[1],m=n[2];return t===e?(e[12]=t[0]*h+t[4]*v+t[8]*m+t[12],e[13]=t[1]*h+t[5]*v+t[9]*m+t[13],e[14]=t[2]*h+t[6]*v+t[10]*m+t[14],e[15]=t[3]*h+t[7]*v+t[11]*m+t[15]):(r=t[0],o=t[1],a=t[2],i=t[3],A=t[4],s=t[5],u=t[6],c=t[7],l=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=o,e[2]=a,e[3]=i,e[4]=A,e[5]=s,e[6]=u,e[7]=c,e[8]=l,e[9]=d,e[10]=f,e[11]=p,e[12]=r*h+A*v+l*m+t[12],e[13]=o*h+s*v+d*m+t[13],e[14]=a*h+u*v+f*m+t[14],e[15]=i*h+c*v+p*m+t[15]),e}function A(){var t=new e(3);return e!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function s(t,n,r){var o=new e(3);return o[0]=t,o[1]=n,o[2]=r,o}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function u(){var t=new e(4);return e!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}A(),function(){var t;t=new e(4),e!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var c;function l(){var t=new e(2);return e!=Float32Array&&(t[0]=0,t[1]=0),t}function d(e,t){var n=t[0],r=t[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e}A(),s(1,0,0),s(0,1,0),u(),u(),c=new e(9),e!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,l();class f{constructor(e,t=0,n=0){this.target=e,this.x=t,this.y=n,this.isMouseDown=!1,this.limitXY()}register(){this.target.addEventListener("pointerdown",(()=>{this.onPointerDown()})),this.target.addEventListener("pointermove",(e=>{this.onPointerMove(e)})),this.target.addEventListener("pointerup",(()=>{this.onPointerUp()}))}onPointerDown(){this.isMouseDown=!0}onPointerMove(e){!0===this.isMouseDown&&(this.x-=e.movementX,this.y-=e.movementY),this.limitXY()}onPointerUp(){!0===this.isMouseDown&&(this.isMouseDown=!1)}limitXY(){this.y=Math.max(-90,Math.min(-10,this.y)),this.x=this.x%360}}class p{constructor(e=1,t=1,n=10,r=10){this.width=e,this.height=t,this.rows=n,this.columns=r,this.indices=[],this.vertecies=[],this.positionOffset=0,this.normalOffset=3,this.uvOffset=6,this.stride=8,this.rows=Math.floor(n)||1,this.columns=Math.floor(r)||1,this.generateVertecies(),this.generateIndices()}generateVertecies(){for(let e=0;e<=this.rows;e++){const t=e*(this.height/this.rows);for(let n=0;n<=this.columns;n++){const r=n*(this.width/this.columns);this.vertecies.push(r,t,0),this.vertecies.push(0,0,1),this.vertecies.push(n/this.columns,1-e/this.rows)}}}generateIndices(){const e=this.columns+1;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++){const r=e*t+n,o=e*t+(n+1),a=e*(t+1)+n,i=e*(t+1)+(n+1);this.indices.push(a,r,o),this.indices.push(i,a,o)}}}var h=n(558),v=n(542),m=n(379),g=n.n(m),w=n(795),y=n.n(w),E=n(569),x=n.n(E),P=n(565),b=n.n(P),M=n(216),S=n.n(M),T=n(589),B=n.n(T),U=n(772),N={};N.styleTagTransform=B(),N.setAttributes=b(),N.insert=x().bind(null,"head"),N.domAPI=y(),N.insertStyleElement=S(),g()(U.Z,N),U.Z&&U.Z.locals&&U.Z.locals;window.addEventListener("load",(function(){var e,t,n,A,c;return t=this,n=void 0,c=function*(){"gpu"in navigator||(document.querySelector("#gpuCanvas").style.display="none",document.querySelector("#error").style.display="block");const t=yield null===(e=navigator.gpu)||void 0===e?void 0:e.requestAdapter();if(!t)throw"Could not retrieve a WebGPU adapter.";const n=yield t.requestDevice(),A=document.querySelector("#gpuCanvas"),c=A.getContext("webgpu"),m=c.getPreferredFormat(t);c.configure({device:n,format:m});const g=n.createShaderModule({code:h}),w=new p(12,12,100,100),y=new Uint32Array(w.indices),E=new Float32Array(w.vertecies),x=n.createBuffer({size:E.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0});new Float32Array(x.getMappedRange()).set(E),x.unmap();const P=n.createBuffer({size:y.byteLength,usage:GPUBufferUsage.INDEX,mappedAtCreation:!0});new Uint32Array(P.getMappedRange()).set(y),P.unmap();const b={arrayStride:w.stride*Float32Array.BYTES_PER_ELEMENT,attributes:[{format:"float32x3",offset:w.positionOffset*Float32Array.BYTES_PER_ELEMENT,shaderLocation:0},{format:"float32x3",offset:w.normalOffset*Float32Array.BYTES_PER_ELEMENT,shaderLocation:1},{format:"float32x2",offset:w.uvOffset*Float32Array.BYTES_PER_ELEMENT,shaderLocation:2}]},M=o();!function(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[4],i=t[5],A=t[6],s=t[7],u=t[8],c=t[9],l=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*o+u*r,e[5]=i*o+c*r,e[6]=A*o+l*r,e[7]=s*o+d*r,e[8]=u*o-a*r,e[9]=c*o-i*r,e[10]=l*o-A*r,e[11]=d*o-s*r}(M,M,r(-90)),i(M,M,[-w.width/2,-w.height/2,0]);const S=n.createBuffer({size:39*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),T=n.createBuffer({size:164,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),B=n.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]}),U=n.createBindGroup({layout:B,entries:[{binding:0,resource:{buffer:S}},{binding:1,resource:{buffer:T}}]}),N=yield function(e){return t=this,n=void 0,o=function*(){const t=yield fetch(e),n=yield t.blob();return yield createImageBitmap(n)},new((r=void 0)||(r=Promise))((function(e,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function A(e){try{s(o.throw(e))}catch(e){a(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,A)}s((o=o.apply(t,n||[])).next())}));var t,n,r,o}(v),F=n.createTexture({size:[N.width,N.height],format:m,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});n.queue.copyExternalImageToTexture({source:N},{texture:F},[N.width,N.height]);const G=n.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"non-filtering"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]}),C=n.createBindGroup({layout:G,entries:[{binding:0,resource:n.createSampler({addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})},{binding:1,resource:F.createView()}]}),R={layout:n.createPipelineLayout({bindGroupLayouts:[B,G]}),vertex:{module:g,entryPoint:"vertex_main",buffers:[b]},fragment:{module:g,entryPoint:"fragment_main",targets:[{format:m}]},depthStencil:{format:"depth32float",depthWriteEnabled:!0,depthCompare:"less"},multisample:{count:4}},L=n.createRenderPipeline(R),D=n.createTexture({size:{width:A.width,height:A.height},sampleCount:4,format:m,usage:GPUTextureUsage.RENDER_ATTACHMENT}).createView(),z=n.createTexture({size:{width:A.width,height:A.height,depthOrArrayLayers:1},sampleCount:4,dimension:"2d",format:"depth32float",usage:GPUTextureUsage.RENDER_ATTACHMENT}),V=new f(A,50,-25);V.register();const I=Date.now();let O=0;requestAnimationFrame((function e(t){const f=function(e,t){const n=o();return function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=n+n,A=r+r,s=o+o,u=n*i,c=r*i,l=r*A,d=o*i,f=o*A,p=o*s,h=a*i,v=a*A,m=a*s;e[0]=1-l-p,e[1]=c+m,e[2]=d-v,e[3]=0,e[4]=c-m,e[5]=1-u-p,e[6]=f+h,e[7]=0,e[8]=d+v,e[9]=f-h,e[10]=1-u-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(n,t),i(n,n,s(0,0,15)),a(n,n),n}(0,function(e,t,n,r){var o=.5*Math.PI/180;t*=o,n*=o,r*=o;var a=Math.sin(t),i=Math.cos(t),A=Math.sin(n),s=Math.cos(n),u=Math.sin(r),c=Math.cos(r);return e[0]=a*s*c-i*A*u,e[1]=i*A*c+a*s*u,e[2]=i*s*u-a*A*c,e[3]=i*s*c+a*A*u,e}(u(),V.y,V.x,0)),p=function(e){const t=a(o(),e);return s(t[12],t[13],t[14])}(f),h=function(e,t,n,r,o){var a,i=1/Math.tan(t/2);return e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a=1/-99.9,e[10]=o*a,e[14]=10*a,e}(o(),r(50),A.width/A.height,0,100),v=function(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],A=t[4],s=t[5],u=t[6],c=t[7],l=t[8],d=t[9],f=t[10],p=t[11],h=t[12],v=t[13],m=t[14],g=t[15],w=n[0],y=n[1],E=n[2],x=n[3];return e[0]=w*r+y*A+E*l+x*h,e[1]=w*o+y*s+E*d+x*v,e[2]=w*a+y*u+E*f+x*m,e[3]=w*i+y*c+E*p+x*g,w=n[4],y=n[5],E=n[6],x=n[7],e[4]=w*r+y*A+E*l+x*h,e[5]=w*o+y*s+E*d+x*v,e[6]=w*a+y*u+E*f+x*m,e[7]=w*i+y*c+E*p+x*g,w=n[8],y=n[9],E=n[10],x=n[11],e[8]=w*r+y*A+E*l+x*h,e[9]=w*o+y*s+E*d+x*v,e[10]=w*a+y*u+E*f+x*m,e[11]=w*i+y*c+E*p+x*g,w=n[12],y=n[13],E=n[14],x=n[15],e[12]=w*r+y*A+E*l+x*h,e[13]=w*o+y*s+E*d+x*v,e[14]=w*a+y*u+E*f+x*m,e[15]=w*i+y*c+E*p+x*g,e}(o(),h,f),m={colorAttachments:[{view:D,resolveTarget:c.getCurrentTexture().createView(),loadValue:{r:.3,g:.3,b:.3,a:1},storeOp:"store"}],depthStencilAttachment:{view:z.createView(),depthLoadValue:1,depthStoreOp:"discard",stencilLoadValue:0,stencilStoreOp:"store"}};n.queue.writeBuffer(S,0,new Float32Array([O]).buffer),n.queue.writeBuffer(S,16,M),n.queue.writeBuffer(S,16+16*Float32Array.BYTES_PER_ELEMENT,v),n.queue.writeBuffer(S,16+32*Float32Array.BYTES_PER_ELEMENT,p);const g=[{waveLength:8,amplitude:.1,steepness:1,direction:d(l(),[1,1.3])},{waveLength:4,amplitude:.1,steepness:.8,direction:d(l(),[-.7,0])},{waveLength:5,amplitude:.2,steepness:1,direction:d(l(),[.3,.2])},{waveLength:10,amplitude:.5,steepness:1,direction:d(l(),[4.3,1.2])},{waveLength:3,amplitude:.1,steepness:1,direction:d(l(),[.5,.5])}],w=new Float32Array(32*g.length/Float32Array.BYTES_PER_ELEMENT);for(let e=0;e<g.length;e++)w[0+8*e]=g[e].waveLength,w[1+8*e]=g[e].amplitude,w[2+8*e]=g[e].steepness,w.set(g[e].direction,4+8*e);n.queue.writeBuffer(T,0,w);const E=g.reduce(((e,t)=>e+t.amplitude),0);n.queue.writeBuffer(T,w.byteLength,new Float32Array([E]).buffer);const b=n.createCommandEncoder(),B=b.beginRenderPass(m);B.setPipeline(L),B.setVertexBuffer(0,x),B.setIndexBuffer(P,"uint32"),B.setBindGroup(0,U),B.setBindGroup(1,C),B.drawIndexed(y.length),B.endPass(),n.queue.submit([b.finish()]),O=(Date.now()-I)/1e3,requestAnimationFrame(e)}))},new((A=void 0)||(A=Promise))((function(e,r){function o(e){try{i(c.next(e))}catch(e){r(e)}}function a(e){try{i(c.throw(e))}catch(e){r(e)}}function i(t){var n;t.done?e(t.value):(n=t.value,n instanceof A?n:new A((function(e){e(n)}))).then(o,a)}i((c=c.apply(t,n||[])).next())}))}))})()})();